# Feature Spec: 02.3 - Step 2 Top Eight

## Overview
Second step where users narrow their "More Important" cards down to exactly 8 most important values.

## User Story
As a participant, I can select my top 8 most important leadership values from my previously sorted "More Important" pile.

## Technical Requirements

### Transition Animation
- [ ] Less Important pile → neat stack → flip face-down → move to discard area (500ms)
- [ ] More Important pile → neat stack → flip face-down → move to main deck position (500ms)
- [ ] Pile labels change: "Top 8 Most Important" and "Less Important"
- [ ] Counter appears: "(0/8)" next to Top 8 pile
- [ ] Step indicator updates to "Step 2 of 3"

### State Management
- [ ] Transfer More Important cards to new deck
- [ ] Initialize empty Top 8 and Less Important piles
- [ ] Track card count in Top 8 pile (0-8)
- [ ] Move previous Less Important cards to discard area
- [ ] Maintain discard pile visibility in bottom-right

### Pile Constraints
- [ ] **Strict Limit**: Exactly 8 cards maximum in Top 8 pile
- [ ] **Real-time Counter**: "(3/8)" updates as cards added/removed
- [ ] **Overflow Protection**: 9th card bounces back with animation
- [ ] **Bounce Animation**: 400ms elastic bounce with warning message
- [ ] **Warning Message**: "Remove a card from Top 8 to add another" (auto-dismiss 3s)

### Card Interaction
- [ ] Same flip and sort mechanics as Step 1
- [ ] Cards can move between Top 8 and Less Important piles
- [ ] Drag validation prevents exceeding 8-card limit
- [ ] Visual feedback when approaching limit (pile glow)
- [ ] Click pile title for quick sorting from staging

### Review Progression
- [ ] "Review Top 8 ➜" button appears when:
  - Exactly 8 cards in Top 8 pile
  - Main deck is empty
  - All cards are sorted
- [ ] Button remains disabled until conditions met
- [ ] Clear validation messaging for unmet conditions

## Layout Structure
```
[← Leave Session]  [👥5 Participants]        [Step 2 of 3] [x]

┌─────────────────────┐     ┌─────────────────────┐
│  Top 8 Most Important│     │   Less Important    │
│       (3/8)         │     │     (15 cards)      │
│   [Card stacks]     │     │   [Card stacks]     │
└─────────────────────┘     └─────────────────────┘

        ┌──────────────────┐
        │   TEAMWORK       │  ← Flipped card (staging)
        │ Cooperative...   │
        └──────────────────┘

┌─────────────────────┐                    ┌──────────┐
│ Leadership Values   │                    │Less Imp  │
│ Cards (10 left)     │                    │(discard) │
└─────────────────────┘                    └──────────┘

                [Review Top 8 ➜]
```

## Instructions Modal
- [ ] Appears on Step 2 entry
- [ ] "Select your Top 8 most important values"
- [ ] Explains the reduction process
- [ ] Mentions ability to move cards between piles
- [ ] "You must select exactly 8 cards to continue"

### Overflow Behavior
- [ ] **Visual Warning**: Top 8 pile border turns red when at limit
- [ ] **Bounce Animation**: 9th card bounces back to origin (400ms elastic)
- [ ] **Toast Message**: Warning appears near Top 8 pile
- [ ] **Counter Highlight**: "(8/8)" shows in bold/colored when full
- [ ] **Drag Prevention**: Visual feedback shows invalid drop zones

## Validation Rules
- [ ] Exactly 8 cards required in Top 8 pile
- [ ] No cards can remain in main deck
- [ ] All cards must be sorted (staging area empty)
- [ ] Cannot exceed 8-card limit in Top 8 pile
- [ ] Must complete sorting before review

## Animation Timings
- **Pile transition**: 500ms ease-out
- **Counter update**: 200ms fade in/out
- **Bounce rejection**: 400ms elastic with overshoot
- **Card flip**: 200-300ms ease-in-out (same as Step 1)
- **Warning message**: 200ms slide-in, auto-dismiss 3000ms

## Error States
- [ ] Warning when trying to exceed 8 cards
- [ ] Validation message if trying to review with wrong count
- [ ] Clear feedback for cards remaining in deck
- [ ] Helpful hints for first-time users

## Accessibility
- [ ] Screen reader announces counter changes
- [ ] Clear visual feedback for pile limits
- [ ] Keyboard navigation for all interactions
- [ ] High contrast support for warnings

## Acceptance Criteria
- [ ] Transition animation completes smoothly from Step 1
- [ ] 8-card limit strictly enforced with appropriate feedback
- [ ] Counter updates accurately and immediately
- [ ] "Review Top 8" button only enables when conditions met
- [ ] Bounce animation provides clear rejection feedback
- [ ] All cards can be sorted with consistent mechanics

## Test Cases
1. Complete Step 1 and verify smooth transition to Step 2
2. Sort exactly 8 cards and verify review button appears
3. Attempt to add 9th card and verify bounce behavior
4. Move cards between piles and verify counter updates
5. Try to proceed with wrong card count (7, 9, etc.)
6. Verify pile limit warnings and visual feedback
7. Test counter accuracy with rapid card movements
8. Verify discard pile visibility and state

## Dependencies
- 02.2 Step 1 Initial Sort ✓
- 03.1 Drag Drop Mechanics ✓
- 03.2 Animations Transitions ✓
- 03.3 Pile Constraints ✓

## Status: 🔴 Not Started