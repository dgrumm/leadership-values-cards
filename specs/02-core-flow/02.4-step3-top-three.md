# Feature Spec: 02.4 - Step 3 Top Three

## Overview
Final step where users select their 3 most important leadership values from their Top 8 selection.

## User Story
As a participant, I can identify my final 3 most important leadership values and complete the exercise.

## Technical Requirements

### Setup Transition
- [x] Top 8 cards â†’ remaining cards moved into neat stack â†’ flip face-down â†’ move to main deck position (500ms)
- [x] Create new empty piles: "Top 3 Most Important" and "Less Important"; match dimensions of Step 1 and Step 2
- [x] Counter appears: "(0/3)" next to Top 3 pile
- [x] Step indicator updates to "Step 3 of 3"
- [x] Previous Less Important cards added to deck in discard area; increment count of discard deck

### State Management
- [ ] Transfer Top 8 cards to new deck for sorting
- [ ] Initialize empty Top 3 and Less Important piles
- [ ] Track card count in Top 3 pile (0-3)
- [ ] Maintain all previous discard piles
- [ ] Preserve participant progress state

### Pile Constraints
- [x] **Strict Limit**: Exactly 3 cards maximum in Top 3 pile
- [x] **Real-time Counter**: "(2/3)" updates as cards added/removed
- [x] **Overflow Protection**: 4th card bounces back with elastic animation
- [x] **Bounce Animation**: 400ms elastic with warning message
- [x] **Warning Message**: "Remove a card from Top 3 to add another" (auto-dismiss 5s enhanced)

### Final Card Interaction
- [ ] Same flip and sort mechanics as previous steps
- [ ] Cards can move between Top 3 and Less Important piles
- [ ] Visual emphasis on Top 3 pile (enhanced styling)
- [ ] Extra confirmation for final selections
- [ ] Click pile title for quick sorting from staging

### Completion Flow
- [ ] "Review Top 3 âœ" button appears when:
  - Exactly 3 cards in Top 3 pile
  - Main deck is empty (all 8 cards sorted)
  - Staging area empty
- [ ] Button styling emphasizes this is the final step
- [ ] Clear completion messaging

## Layout Structure
```
[â† Leave Session]  [ğŸ‘¥5 Participants]        [Step 3 of 3] [x]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Top 3 Most Importantâ”‚     â”‚   Less Important    â”‚
â”‚       (2/3)         â”‚     â”‚      (3 cards)      â”‚
â”‚   [Card stacks]     â”‚     â”‚   [Card stacks]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    TRUST         â”‚  â† Flipped card (staging)
        â”‚ Firm reliance... â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
â”‚ Leadership Values   â”‚    â”‚Step â”‚ â”‚Step â”‚
â”‚ Cards (3 left)      â”‚    â”‚1    â”‚ â”‚2    â”‚  â† Discard areas
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚Disc â”‚ â”‚Disc â”‚
                           â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜
                [Review Top 3 âœ]
```

## Game Steps Modal
- [ ] "Select your Top 3 most important values"
- [ ] "This is your final selection - choose carefully"
- [ ] Emphasizes importance of this step
- [ ] "These 3 values will represent your core leadership priorities"
- [ ] Dismissible with "Got it" button
- [ ] Clicking "Step 3 of 3" in header will re-display modal
- [ ] User can view game progress any time by clicking the "Step x of y" button in header  
- [ ] Step button shows clickable chevron icon to indicate side panel functionality
- [ ] Game Steps Modal shows current state - number of cards sorted into each pile, number of cards in deck left to sort

### Enhanced Visual Design
- [ ] Top 3 pile has premium styling (gold border, glow effect)
- [ ] Cards in Top 3 pile have special highlighting
- [ ] Counter shows "(3/3)" in success color when complete
- [ ] "Review Top 3" button has celebration styling
- [ ] Discard areas clearly organized and labeled

## Validation Rules
- [ ] Exactly 3 cards required in Top 3 pile
- [ ] All 8 cards from Step 2 must be sorted
- [ ] No cards can remain in main deck
- [ ] Staging area must be empty for completion
- [ ] Cannot exceed 3-card limit in Top 3 pile

## Completion State
- [ ] Clear visual celebration when 3 cards selected
- [ ] Subtle animation on completion (particles, glow)
- [ ] Confirmation message: "You've identified your top 3 leadership values!"
- [ ] Button text emphasizes finality: "Complete Exercise âœ"

## Overflow Behavior
- [ ] **Strong Visual Warning**: Top 3 pile glows red when at limit
- [ ] **Enhanced Bounce**: More pronounced rejection animation (400ms)
- [ ] **Persistent Warning**: Message stays visible longer (5s)
- [ ] **Audio Feedback**: Optional subtle sound for rejection
- [ ] **Haptic Feedback**: Vibration on mobile devices

## Progression to Review
- [ ] Transition leads to final review screen
- [ ] All sorting mechanics disabled in review
- [ ] Focus shifts to arrangement and sharing
- [ ] Clear completion status for other participants

## Error Handling
- [ ] Clear messaging for wrong card count
- [ ] Visual emphasis on required actions
- [ ] Helpful guidance for completing final selection
- [ ] Graceful handling of rapid interactions

## Accessibility
- [ ] Screen reader emphasizes final step importance
- [ ] Clear announcements for completion state
- [ ] Enhanced focus indicators for final selections
- [ ] High contrast mode support for premium styling

## Acceptance Criteria
- [x] Smooth transition from Step 2 with Top 8 cards
- [x] 3-card limit strictly enforced with enhanced feedback
- [x] Counter updates reflect premium nature of final step
- [x] Completion state clearly celebrated and confirmed
- [x] "Review Top 3" only enables with exact requirements
- [x] Visual design emphasizes importance and finality

## Test Cases
1. Complete Step 2 and verify transition to Step 3
2. Sort exactly 3 cards and verify completion state
3. Attempt to add 4th card and verify enhanced rejection
4. Move cards between piles and verify counter accuracy
5. Try to proceed with wrong card count (1, 2, 4+)
6. Verify enhanced visual feedback and celebration
7. Test completion messaging and state updates
8. Verify all discard areas remain organized

## Dependencies
- 02.3 Step 2 Top Eight âœ“
- 03.1 Drag Drop Mechanics âœ“
- 03.2 Animations Transitions âœ“
- 03.3 Pile Constraints âœ“

## Status: ğŸŸ¢ Complete